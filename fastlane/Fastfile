default_platform(:ios)

platform :ios do
  desc "커스텀 릴리즈"
  lane :custom_release do
    # ① 푸시 인증서·설정 준비

    cocoapods(clean_install: true, try_repo_update_on_error: true )
    run_tests(scheme: "BioLogTests", fail_build: false)

    # ② App Store Connect API 키 인증
    match(type:"appstore")
    build_app(scheme: "BioLog")
    pilot( api_key_path: "fastlane/6UA8N7RLF2.json",
           ipa: "./BioLog.ipa"   )
  end

  desc "빌드→아카이브→내보내기→TestFlight 업로드"
  lane :release do
    match(type:"appstore")
    build_app(scheme: "BioLog")
    pilot(api_key_path: "fastlane/6UA8N7RLF2.json", ipa: "./BioLog.ipa")
  end
end